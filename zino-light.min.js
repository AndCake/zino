var __zino=function(e){"use strict";function t(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.forEach(function(t){for(var r in t)("undefined"!=typeof HTMLElement&&t instanceof HTMLElement||void 0!==n(t,r).value&&(!e[r]||n(e,r).writable))&&"attributes"!==r&&(e[r]=t[r])}),e}function n(e,t){return R(e)&&Object.getOwnPropertyDescriptor(e,t)||{}}function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function a(e,t){return Array.prototype.slice.call(e,t||0)}function o(e,t){t.name.indexOf("--event-")&&i("--event-"+e,t)}function i(e,t){if(o("trigger",{name:e,data:t}),Z[e])for(var n in Z[e]){var r=Z[e][n](t);if(!1===r)break}}function c(e,t){Z[e]||(Z[e]=[]),Z[e].push(t),o("register",{name:e,fn:t})}function u(e,t){if(!q(t))return delete Z[e],o("unregister",{name:e});for(var n in Z[e])if(Z[e][n]===t)return delete Z[e][n],o("unregister",{name:e,fn:t})}function s(e,t){c(e,function n(){t.apply(this,arguments),u(e,n)})}function l(e,t,n){if(q(e.addEventListener)){var r=function(t,r){for(var o=a(e.querySelectorAll(t));o.length>0&&r!==n;){if(o.indexOf(r)>=0)return o[o.indexOf(r)];r=r.parentNode}return!1};t.forEach(function(t){Object.keys(t.handlers).forEach(function(a){e.addEventListener(a,function(e){var o=void 0;(":host"===t.selector||(o=r(t.selector,e.target)))&&(o&&(o.getHost=function(){return n.getHost()}),t.handlers[a].call(o||n,e))},!1)})})}}function f(e,t){var n={};t.addEventListener.toString().indexOf("[native code]")>=0&&e.events.forEach(function(e){var r=e.tag;R(r)||(n[r]=(n[r]||0)+1,r=t.querySelectorAll(r)[n[r]-1]),r&&r.children.length>0&&!r.children[0].__eventsAttached&&(l(r.children[0],e.childEvents,r),l(r,e.hostEvents,r),r.children[0].__eventsAttached=!0)})}function d(e){return"[object Array]"===Object.prototype.toString.call(e)}function h(e){var t=0,n=void 0,r=void 0;if(0===e.length)return t;for(n=0;n<e.length;n++)r=e.charCodeAt(n),t=(t<<5)-t+r,t|=0;return t}function g(e){B=e}function m(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];e=e.toLowerCase(),t=t||{};var o="";Object.keys(t).forEach(function(e){t[e]={name:e,value:"object"!==z(t[e])?t[e]:"--"+B(e,t[e])+"--"},o+=e+t[e].value}),r=1===r.length&&Array.isArray(r[0])?r[0]:r;var i={tagName:e,attributes:t,children:r.filter(function(e){return e}),__hash:h(e+"!"+o+"@"+r.map(function(e){return e&&e.__hash||e}).join("!"))};return P.indexOf(e)>=0&&$.push(i),i}function v(e){P=e}function p(){$=[]}function b(){return $}function y(e){return e.children?(d(e.children)||(e.children=[e.children]),(d(e)&&e||e.children).map(function(e){if("object"!==(void 0===e?"undefined":z(e)))return""+e;if(d(e))return y(e);var t=[""].concat(Object.keys(e.attributes).map(function(t){return t+'="'+e.attributes[t].value+'"'}));return["img","link","meta","input","br","area","base","param","source","hr","embed"].indexOf(e.tagName)<0?"<"+e.tagName+t.join(" ")+">"+y(e)+"</"+e.tagName+">":"<"+e.tagName+t.join(" ")+"/>"}).join("")):""}function _(e,t){var n=void 0;return"object"!==(void 0===e?"undefined":z(e))?n=t.createTextNode(""+e):(n=t.createElement(e.tagName),Object.keys(e.attributes).forEach(function(t){n.setAttribute(t,e.attributes[t].value)}),n.innerHTML=y(e),n.__hash=e.__hash),n}function E(e,t,n,r){if((n||"").match(/<[\w:_-]+[^>]*>/))if(1===t.childNodes.length)t.innerHTML=n;else{var a=r.createElement("span");a.innerHTML=n,t.replaceChild(a,e)}else t.replaceChild(_((n||"").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),r),e)}function x(e,t,n){d(t)||(d(t.children)||(t.children=[t.children]),e.__hash!==t.__hash&&(t.tagName!==e.tagName.toLowerCase()?e.parentNode.replaceChild(_(t,n),e):(Object.keys(t.attributes).forEach(function(n){if("object"!==z(t.attributes[n].value))e.getAttribute(n)!=t.attributes[n].value&&e.setAttribute(n,t.attributes[n].value);else if(e.getAttribute(n)&&e.getAttribute(n).match(/^--|--$/g)){var r=B(n,t.attributes[n].value,e.getAttribute(n).replace(/^--|--$/g,""));e.setAttribute(n,"--"+r+"--")}}),e.attributes.length>Object.keys(t.attributes).length&&[].forEach.call(e.attributes,function(n){void 0===t.attributes[n.name]&&e.removeAttribute(n.name)}))));var r=d(t)?t:t.__hash!==e.__hash?t.children:[];r.forEach(function(t,r){if(d(t))return x(e,t,n);var a=e.childNodes[r];void 0===a?e.appendChild(_(t,n)):3===a.nodeType?"string"==typeof t&&a.nodeValue!==t?E(a,e,t,n):"string"!=typeof t&&e.replaceChild(_(t,n),a):1===a.nodeType&&("object"===(void 0===t?"undefined":z(t))?x(a,t,n):E(a,e,t,n))}),e.__hash!==t.__hash&&e.childNodes.length>r.length&&a(e.childNodes,r.length).forEach(function(t){return e.removeChild(t)}),e.__hash=t.__hash}function w(e,n,r){var o=e(m,r),c=o.tagName||(e.name||"").replace(/([A-Z])/g,function(e,t){return"-"+t}).toLowerCase().replace(/^-/,"");if(I[c])return void(n&&a(n.getElementsByTagName(c)).forEach(function(e){return O(e,I[c])}));i("publish-style",{styles:o.styles,tagName:c}),o.functions=t({},J,o.functions),I[c]=o,n&&a(n.getElementsByTagName(c)).forEach(function(e){return O(e,I[c])})}function N(e,t){if(!e.tagName)return{};var n=I[e.tagName.toLowerCase()];return!n||e.getAttribute("__ready")?{}:(t&&(n.functions.render=D),O.call(t?{noEvents:!0}:this,e,n))}function A(e){if(e&&e.addEventListener){f(k(e),e)}}function O(e,t){if(!e.__vdom&&t){var n=t.functions;if(e.children.length>0&&e.children[0].attributes&&e.children[0].attributes.class&&"-shadow-root"===e.children[0].attributes.class.value){var r=e.children[1];r&&"-original-root"===r.className&&(e.__i=r.innerHTML,T(r,e),r.parentNode.removeChild(r)),e.isRendered=!0}else e.__i=e.ownerDocument?e.innerHTML:y(e),T(e),e.innerHTML='<div class="-shadow-root"></div>',e.isRendered=!1;if(!e.nodeType)for(;e.children.length>1;)e.children.pop();i("--zino-initialize-node",{tag:e,node:n}),e.__vdom={};var a=!e.isRendered&&k.call(this,e)||{events:[]},o=[],c=n.events||[],u=Object.keys(c).filter(function(t){var n=":host"!==t&&t!==e.tagName;return n||o.push({handlers:c[t],selector:t}),n}).map(function(e){return{selector:e,handlers:c[e]}});if(a.events=a.events.concat({childEvents:u,hostEvents:o,tag:this&&this.noEvents?e.tagName:e}),e.attributes.__ready||L(e,"__ready",!0),this&&!0===this.noEvents)return a;f(a,e),[e].concat(e.__subs).forEach(function(e){var t=e&&e.getHost()||{};q(t.onready)&&t.onready.call(t)})}}function L(e,t,n){e.ownerDocument?(e.prototype||HTMLElement.prototype).setAttribute.call(e,t,n):e.attributes[t]={name:t,value:n}}function j(e){var n=e.tag,r=e.node,a=void 0===r?J:r;for(var o in a){var c=a[o];["mount","unmount","events","render"].indexOf(o)<0&&(q(c)?n[o]=c.bind(n):n[o]=R(n[o])?t({},c,n[o]):c)}var u=Object.getOwnPropertyDescriptor(n,"body");u&&void 0!==u.get||Object.defineProperty(n,"body",{set:function(e){n.__i=e,T(n),i("--zino-rerender-tag",n.getHost())},get:function(){return n.__i}}),n.setAttribute=function(e,t){L(this,e,t),i("--zino-rerender-tag",this)},n.props=t({},a.props,H(n,!0)),n.attrs=H(n);try{n.mounting=!0,a.mount.call(n),delete n.mounting}catch(e){throw new Error("Unable to call mount function for "+n.tagName+": "+(e.message||e))}}function k(e){function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r="";for(var a in e)"object"!==z(e[a])?r+=a+": "+(null===e[a]||void 0===e[a]?"null":e[a]).toString()+"\n":(r+=a+": {\n",t<10&&(0!==t||"element"!==a)&&(r+=n(e[a],t+1)),r+="}\n");return r}var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I[e.tagName.toLowerCase()],o=[],i=[],c=[],u=void 0;g(F),p();var s=H(e),l=h(n(s));if(e.__dataHash===l)return{events:o,renderCallbacks:i,data:s,subElements:c};if(e.__dataHash=l,!q(r.render))throw new Error("No render function provided in component "+e.tagName);v(Object.keys(I)),u=m("div",{class:"-shadow-root"},r.render.call(e,s)),e.__subs&&e.__subs.forEach(C),c=b();for(var f=0,d=c.length;f<d;f+=1){var _=c[f],E=O.call({noRenderCallback:!0,noEvents:!0},_,I[_.tagName]);E&&(c.splice.apply(c,[f+1,0].concat(E.subElements)),f+=E.subElements.length,d+=E.subElements.length,o=o.concat(E.events),i=i.concat(E.renderCallbacks))}e.ownerDocument?x(e.children[0],u,e.ownerDocument):(e.children[0]=u,e.children[0].__hash=u.__hash),e.__subs=c,e.__vdom=u;var w=!1;do{w&&(e.children[0].innerHTML=y(u),w=!1),c.length>0&&(e.querySelectorAll&&a(e.querySelectorAll("[__ready]"))||[]).forEach(function(n,r,a){if(t(n,c[r]),!c[r]||n.tagName.toLowerCase()!==c[r].tagName)return console.info("Inconsistent state - might be caused by additional components generated in render callback: ",n,e.__subs,a),void(w=!0);n.getHost=c[r].getHost=J.getHost.bind(n)})}while(w);if(e.isRendered=!0,this&&this.noRenderCallback)i.push({fn:r.functions.render,tag:e});else{i.forEach(function(e){try{e.fn.call(e.tag.getHost())}catch(t){throw new Error("Unable to call render callback for component "+e.tag.tagName+": "+(t.message||t))}});try{r.functions.render.call(e)}catch(t){throw new Error("Unable to call render callback for component "+e.tagName+": "+(t.message||t))}}return{events:o,renderCallbacks:i,data:s,subElements:c}}function C(e){var t=(e.tagName||"").toLowerCase(),n=I[t];if(n){[].forEach.call(1===e.nodeType&&e.attributes||Object.keys(e.attributes).map(function(t){return e.attributes[t]}),function(e){e.name.indexOf("data-")>=0&&delete G[e.value]});try{n.__subs&&n.__subs.forEach(C),n.functions.unmount.call(e)}catch(e){throw new Error("Unable to unmount tag "+t+": "+(e.message||e))}}}function H(e,t){var n={props:e.props,element:e.element,styles:e.styles,body:e.__i},r=n.props;return[].forEach.call(1===e.nodeType&&e.attributes||Object.keys(e.attributes).map(function(t){return e.attributes[t]}),function(e){var t=e.name.indexOf("data-")>=0&&"string"==typeof e.value&&"--"===e.value.substr(0,2),a=e.value;n[e.name]||(n[e.name]=t&&"string"==typeof a&&G[a.replace(/^--|--$/g,"")]||a),0===e.name.indexOf("data-")&&(r[e.name.replace(/^data-/g,"").replace(/(\w)-(\w)/g,function(e,t,n){return t+n.toUpperCase()})]=n[e.name])}),t?r:n}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n={};[].forEach.call(e.children,function(e){if(e.tagName){var t=e.tagName.toLowerCase();n[t]?(n[t].isArray||(n[t]=[n[t]],n[t].isArray=!0),n[t].push(e)):n[t]=e}}),t.element=n}function S(e){te=e}function M(e,t){for(;e.length>0;)e[0].addEventListener?t(e.shift()):e.shift()}var z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R=function(e){return"object"===(void 0===e?"undefined":z(e))},q=function(e){return"function"==typeof e},D=function(){},U=function(e){return e},Z={},P=[],$=[],B=function(e,t){return e},F=function(e,t,n){var a=r();return n&&delete G[n],G[a]=t,a},I={},G={},J={props:{},mount:D,unmount:D,render:D,getHost:function(){return this},setProps:function e(t,n){var r=this.getHost();if(R(t)){r.mounting=!0;for(var a in t)e.call(this,a,t[a]);r.mounting=!1}else{r.props[t]=n;var o="data-"+t.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()});r.attributes[o]&&L(r,o,"--"+F(t,n,r.attributes[o].value)+"--")}!r.mounting&&i("--zino-rerender-tag",r)}};c("--zino-initialize-node",j);var V=void 0,X=D,K={on:c,one:s,off:u,trigger:i,fetch:D,import:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D,n=function(e){e&&(q(e.setDocument)&&e.setDocument(V),w(e,V.body,K)),t()};"function"==typeof e?n(e):X((this.path||"")+e,n)}},Q={mount:N,render:A,unmount:C};c("publish-style",function(e){if("string"==typeof e.tagName&&e.styles&&e.styles.length>0){if(V.getElementById("style:"+e.tagName))return;var t=V.createElement("style");t.innerHTML=e.styles,t.setAttribute("id","style:"+e.tagName),V.head.appendChild(t)}});var W=window.zinoTagRegistry||{},Y=[],ee=[],te=U,ne=new MutationObserver(function(e){e.forEach(function(e){var t=e.addedNodes,n=e.removedNodes;t.length>0?ee=[].concat.call(t,ee):n.length>0&&[].forEach.call(n,function(e){(e.children&&a(e.querySelectorAll("[__ready]"))||[]).concat(e).forEach(Q.unmount)})})});return function(e){G=e}(window.zinoDataRegistry||{}),window.Zino=K,K.isBrowser=!0,K.isServer=!1,K.fetch=function(e,t,n,r){if(n&&W[e]&&!W[e].callback)return t(W[e],200);if(R(W[e]))return W[e].callback.push(t);if(W[e]=r||{callback:[t]},!r){var a=new XMLHttpRequest;a.open("GET",e,!0),a.onreadystatechange=function(){if(4===a.readyState){var t=W[e].callback;200===a.status&&(W[e]=a.responseText),n||delete W[e],t.forEach(function(e){return e(a.responseText,a.status)})}},a.send()}},function(e){X=e}(function(e,t){K.fetch(e,function(n,r){var a=e.replace(/[^\/]+$/g,"");if(200===r){var o=void 0;try{n=te(n),o=new Function("return "+n.replace(/url\((\\*['"])?(.*?)\1\)/g,function(e,t,n){return 0===n.indexOf("data:")||0===n.indexOf("http")||0===n.indexOf("//")||0===n.indexOf("/")?e:"url("+a+n+")"}).replace(/\bZino.import\s*\(/g,"Zino.import.call({path: "+JSON.stringify(a)+"}, ").trim().replace(/;$/,""))(),"function"==typeof o(function(){},K)&&(o=o())}catch(t){throw t.message="Unable to import tag "+e.replace(/.*\//g,"")+": "+t.message,t}t(o)}},!0)}),function(e){V=e}(window.document),K.on("--zino-rerender-tag",function(e){return Y.indexOf(e)<0&&Y.push(e)}),K.trigger("publish-style","[__ready] { contain: content; }"),a(document.querySelectorAll('[rel="zino-tag"]')).forEach(function(e){return K.import(e.href)}),ne.observe(document.body,{subtree:!0,childList:!0}),requestAnimationFrame(function e(){K.isRendering||(K.isRendering=!0,M(ee,Q.mount),M(Y,Q.render),K.isRendering=!1,requestAnimationFrame(e))}),e.Zino=K,e.setParser=S,e}({});
//# sourceMappingURL=zino-light.min.js.map