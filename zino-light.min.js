!function(e){"use strict";function t(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return r.forEach(function(t){for(var r in t)("undefined"!=typeof HTMLElement&&t instanceof HTMLElement||void 0!==n(t,r).value&&(!e[r]||n(e,r).writable))&&"attributes"!==r&&(e[r]=t[r])}),e}function n(e,t){return M(e)&&Object.getOwnPropertyDescriptor(e,t)||{}}function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}function o(e,t){return Array.prototype.slice.call(e,t||0)}function a(e,t){t.name.indexOf("--event-")&&i("--event-"+e,t)}function i(e,t){if(R[e])for(var n in R[e]){a("trigger",{name:e,fn:R[e][n],data:t});var r=R[e][n](t);if(!1===r)break}}function c(e,t){R[e]||(R[e]=[]),R[e].push(t),a("register",{name:e,fn:t})}function u(e,t){if(!z(t))return delete R[e],a("unregister",{name:e});for(var n in R[e])if(R[e][n]===t)return delete R[e][n],a("unregister",{name:e,fn:t})}function s(e,t){c(e,function n(){t.apply(this,arguments),u(e,n)})}function l(e,t,n){if(z(e.addEventListener)){var r=function(t,r){for(var o=e.querySelectorAll(t);o.length>0&&r!==n;){if(o.indexOf(r)>=0)return o[o.indexOf(r)];r=r.parentNode}return!1};t.forEach(function(t){Object.keys(t.handlers).forEach(function(o){e.addEventListener(o,function(e){var a=void 0;(":host"===t.selector||(a=r(t.selector,e.target)))&&(a&&(a.getHost=function(){return n.getHost()}),t.handlers[o].call(a||n,e))},!1)})})}}function f(e,t){var n={};t.addEventListener.toString().indexOf("[native code]")>=0&&e.events.forEach(function(e){var r=e.tag;isObj(r)||(n[r]=(n[r]||0)+1,r=t.querySelectorAll(r)[n[r]-1]),r.children[0].__eventsAttached||(l(r.children[0],e.childEvents,r),l(r,e.hostEvents,r),r.children[0].__eventsAttached=!0)})}function d(e){return"[object Array]"===Object.prototype.toString.call(e)}function h(e){U=e}function g(e,t,n){e=e.toLowerCase(),t=t||{},Object.keys(t).forEach(function(e){t[e]={name:e,value:t[e]}}),n=n&&("object"!==(void 0===n?"undefined":S(n))||n.tagName)?[n]:n||[];var r={tagName:e,attributes:t,children:n,__complexity:n.reduce(function(e,t){return e+(t.__complexity||1)},0)+n.length};return Z.indexOf(e)>=0&&P.push(r),r}function v(e){Z=e}function m(){P=[]}function p(){return P}function b(e){return e.children?(d(e.children)||(e.children=[e.children]),(d(e)&&e||e.children).map(function(e){if("object"!==(void 0===e?"undefined":S(e)))return""+e;if(d(e))return b(e);var t=[""].concat(Object.keys(e.attributes).map(function(t){return"object"===S(e.attributes[t].value)?t+'="--'+U(t,e.attributes[t].value)+'--"':t+'="'+e.attributes[t].value+'"'}));return"<"+e.tagName+t.join(" ")+">"+b(e)+"</"+e.tagName+">"}).join("")):""}function y(e,t){var n=void 0;return"object"!==(void 0===e?"undefined":S(e))?n=t.createTextNode(""+e):(n=t.createElement(e.tagName),Object.keys(e.attributes).forEach(function(t){n.setAttribute(t,e.attributes[t].value)}),e.__vdom&&i("--zino-initialize-node",{tag:n,node:e.functions}),n.innerHTML=b(e)),n}function x(e,t,n,r){if(n.match(/<[\w:_-]+[^>]*>/))if(1===t.childNodes.length)t.innerHTML=n;else{var o=r.createElement("span");o.innerHTML=n,t.replaceChild(o,e)}else t.replaceChild(y(n.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),r),e)}function E(e,t,n){d(t)||(d(t.children)||(t.children=[t.children]),t.tagName!==e.tagName.toLowerCase()?e.parentNode.replaceChild(y(t,n),e):(Object.keys(t.attributes).forEach(function(n){if("object"!==S(t.attributes[n].value))e.getAttribute(n)!=t.attributes[n].value&&e.setAttribute(n,t.attributes[n].value);else if(e.getAttribute(n)&&e.getAttribute(n).match(/^--|--$/g)){var r=U(n,t.attributes[n].value,e.getAttribute(n).replace(/^--|--$/g,""));e.setAttribute(n,"--"+r+"--")}}),e.attributes.length>Object.keys(t.attributes)&&[].forEach.call(e.attributes,function(n){void 0===t.attributes[n.name]&&e.removeAttribute(n.name)})));var r=d(t)?t:t.children;r.forEach(function(t,r){if(d(t))return E(e,t,n);var o=e.childNodes[r];void 0===o?e.appendChild(y(t,n)):3===o.nodeType?"string"==typeof t&&o.nodeValue!==t?x(o,e,t,n):"string"!=typeof t&&e.replaceChild(y(t,n),o):1===o.nodeType&&("object"===(void 0===t?"undefined":S(t))?E(o,t,n):x(o,e,t,n))}),e.childNodes.length>r.length&&o(e.childNodes,r.length).forEach(function(t){return e.removeChild(t)})}function _(e,n,r){var a=e(g,r),c=a.tagName;B[c]||(i("publish-style",{styles:a.styles,tagName:c}),a.functions=t({},I,a.functions),B[c]=a,n&&o(n.getElementsByTagName(c)).forEach(function(e){return O(e,B[c])}))}function N(e,t){if(e.tagName){var n=B[e.tagName.toLowerCase()];if(n&&!e.getAttribute("__ready"))return t&&(n.functions.render=q),O.call(t?{noEvents:!0}:this,e,n)}}function w(e){f(T(e),e)}function O(e,t){if(!e.__vdom&&t){var n=t.functions;if(e.children.length>0&&e.children[0].attributes&&e.children[0].attributes.class&&"-shadow-root"===e.children[0].attributes.class.value){var r=e.children[1];r&&"-original-root"===r.className&&(e.__i=r.innerHTML,C(r,e),r.parentNode.removeChild(r)),e.isRendered=!0}else e.__i=e.ownerDocument?e.innerHTML:b(e),C(e),e.innerHTML='<div class="-shadow-root"></div>',e.isRendered=!1;i("--zino-initialize-node",{tag:e,node:n}),e.__vdom={};var o=!e.isRendered&&T.call(this,e)||{events:[]},a=[],c=n.events||[],u=Object.keys(c).filter(function(t){var n=":host"!==t&&t!==e.tagName;return n||a.push({handlers:c[t],selector:t}),n}).map(function(e){return{selector:e,handlers:c[e]}});if(o.events=o.events.concat({childEvents:u,hostEvents:a,tag:this&&this.noEvents?e.tagName:e}),e.attributes.__ready||A(e,"__ready",!0),this&&!0===this.noEvents)return o;f(o,e),[e].concat(e.__subs).forEach(function(e){var t=e&&e.getHost()||{};z(t.onready)&&t.onready.call(t)})}}function A(e,t,n){e.ownerDocument?(e.prototype||HTMLElement.prototype).setAttribute.call(e,t,n):e.attributes[t]={name:t,value:n}}function j(e){var n=e.tag,r=e.node,o=void 0===r?I:r;for(var a in o){var c=o[a];["mount","unmount","events","render"].indexOf(a)<0&&(z(c)?n[a]=c.bind(n):n[a]=M(n[a])?t({},c,n[a]):c)}var u=Object.getOwnPropertyDescriptor(n,"body");u&&void 0!==u.get||Object.defineProperty(n,"body",{set:function(e){n.__i=e,C(n),i("--zino-rerender-tag",n.getHost())},get:function(){return n.__i}}),n.setAttribute=function(e,t){A(this,e,t),i("--zino-rerender-tag",this)},n.props=t({},o.props,H(n,!0)),n.attrs=H(n);try{n.mounting=!0,o.mount.call(n),delete n.mounting}catch(e){throw new Error("Unable to call mount function for "+n.tagName+": "+(e.message||e))}}function T(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B[e.tagName.toLowerCase()],r=[],a=[],i=[],c=void 0;h(F.resolveData),m();var u=H(e);if(!z(n.render))throw new Error("No render function provided in component "+e.tagName);v(Object.keys(B)),c=g("div",{class:"-shadow-root"},n.render.call(e,u)),e.__subs&&e.__subs.forEach(L),i=p();for(var s=0,l=i.length;s<l;s+=1){var f=i[s],d=O.call({noRenderCallback:!0,noEvents:!0},f,B[f.tagName]);d&&(i.splice.apply(i,[s+1,0].concat(d.subElements)),s+=d.subElements.length,l+=d.subElements.length,r=r.concat(d.events),a=a.concat(d.renderCallbacks))}return e.ownerDocument?E(e.children[0],c,e.ownerDocument):e.children[0]=c,e.__subs=i,e.__vdom=c,i.length>0&&(e.querySelectorAll&&o(e.querySelectorAll("[__ready]"))||[]).forEach(function(e,n){t(e,i[n]),e.getHost=i[n].getHost=I.getHost.bind(e)}),e.isRendered=!0,this&&this.noRenderCallback?a.push({fn:n.functions.render,tag:e}):(a.forEach(function(e){return e.fn.call(e.tag.getHost())}),n.functions.render.call(e)),{events:r,renderCallbacks:a,data:u,subElements:i}}function L(e){var t=(e.tagName||"").toLowerCase(),n=B[t];if(n){[].forEach.call(1===e.nodeType&&e.attributes||Object.keys(e.attributes).map(function(t){return e.attributes[t]}),function(e){e.name.indexOf("data-")>=0&&delete G[e.value]});try{n.functions.unmount.call(e)}catch(e){throw new Error("Unable to unmount tag "+t+": "+(e.message||e))}}}function H(e,t){var n={props:e.props,element:e.element,styles:e.styles,body:e.__i},r=n.props;return[].forEach.call(1===e.nodeType&&e.attributes||Object.keys(e.attributes).map(function(t){return e.attributes[t]}),function(e){var t=e.name.indexOf("data-")>=0&&"string"==typeof e.value&&"--"===e.value.substr(0,2),o=e.value;n[e.name]||(n[e.name]=t&&"string"==typeof o&&G[o.replace(/^--|--$/g,"")]||o),0===e.name.indexOf("data-")&&(r[e.name.replace(/^data-/g,"").replace(/(\w)-(\w)/g,function(e,t,n){return t+n.toUpperCase()})]=n[e.name])}),t?r:n}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n={};[].forEach.call(e.children,function(e){if(e.tagName){var t=e.tagName.toLowerCase();n[t]?(n[t].isArray||(n[t]=[n[t]],n[t].isArray=!0),n[t].push(e)):n[t]=e}}),t.element=n}function k(e){W=e}var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M=function(e){return"object"===(void 0===e?"undefined":S(e))},z=function(e){return"function"==typeof e},q=function(){},D=function(e){return e},R={},Z=[],P=[],U=function(e,t){return e},F={resolveData:function(e,t,n){var o=r();return n&&delete G[n],G[o]=t,o}},B={},G={},I={props:{},mount:q,unmount:q,render:q,getHost:function(){return this},setProps:function(e,n){var r=this.getHost();if(M(e))t(r.props,e);else{r.props[e]=n;var o="data-"+e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()});r.attributes[o]&&A(r,o,"--"+F.resolveData(e,n,r.attributes[o].value)+"--")}!r.mounting&&i("--zino-rerender-tag",r)}};c("--zino-initialize-node",j);var J=void 0,V=q,X={on:c,one:s,off:u,trigger:i,fetch:q,import:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:q;V((this.path||"")+e,function(e){e&&_(e,J.body,X),t()})}},K={mount:N,render:w,unmount:L};c("publish-style",function(e){if("string"==typeof e.tagName&&e.styles.length>0){if(J.getElementById("style:"+e.tagName))return;var t=J.createElement("style");t.innerHTML=e.styles,t.id="style:"+e.tagName,J.head.appendChild(t)}});var Q={}.dirtyTags=[],W=D,Y=new MutationObserver(function(e){e.forEach(function(e){var t=e.addedNodes,n=e.removedNodes;t.length>0?[].forEach.call(t,K.mount):n.length>0&&[].forEach.call(n,function(e){(e.children&&$("[__ready]",e)||[]).concat(e).forEach(K.unmount)})})});window.Zino=X,X.fetch=function(e,t,n,r){if(n&&Q[e]&&!Q[e].callback)return t(Q[e],200);if(M(Q[e]))return Q[e].callback.push(t);if(Q[e]=r||{callback:[t]},!r){var o=new XMLHttpRequest;o.open("GET",e,!0),o.onreadystatechange=function(){if(4===o.readyState){var t=Q[e].callback;200===o.status&&(Q[e]=o.responseText),n||delete Q[e],t.forEach(function(e){return e(o.responseText,o.status)})}},o.send()}},function(e){V=e}(function(e,t){X.fetch(e,function(n,r){var o=e.replace(/[^\/]+$/g,"");if(200===r){var a=void 0;try{n=W(n),a=new Function("return "+n.replace(/url\((\\*['"])?(.*?)\1\)/g,function(e,t,n){return 0===n.indexOf("data:")||0===n.indexOf("http")||0===n.indexOf("//")||0===n.indexOf("/")?e:"url("+o+n+")"}).replace(/\bZino.import\s*\(/g,"Zino.import.call({path: "+JSON.stringify(o)+"}, ").trim().replace(/;$/,""))()}catch(t){throw t.message="Unable to import tag "+e.replace(/.*\//g,"")+": "+t.message,t}t(a)}},!0)}),function(e){J=e}(window.document),X.on("--zino-rerender-tag",function(e){return dirtyTags.indexOf(e)<0&&dirtyTags.push(e)}),X.trigger("publish-style","[__ready] { contain: content; }"),o(document.querySelectorAll('[rel="zino-tag"]')).forEach(function(e){return X.import(e.href)}),Y.observe(document.body,{subtree:!0,childList:!0}),requestAnimationFrame(function e(){for(;dirtyTags.length>0;)K.render(dirtyTags.shift());requestAnimationFrame(e)}),e.Zino=X,e.setParser=k}(this.Zino=this.Zino||{});
//# sourceMappingURL=zino-light.min.js.map