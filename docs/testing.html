<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Testing</title>
  <meta name="description" content="A micro component framework - easy to learn and powerful.
">

  <link rel="stylesheet" href="/zino/css/main.css">
  <link rel="canonical" href="https://andcake.github.io/zino/testing">
  <link rel="alternate" type="application/rss+xml" title="zino" href="https://andcake.github.io/zino/feed.xml">
</head>


  <body>

    <a href="https://github.com/AndCake/zino"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>

<header class="site-header">
<nav class="site-nav">
    <a class="site-title" href="/zino/">zino</a>

  <a href="#" class="menu-icon">
    <svg viewBox="0 0 18 15">
      <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
      <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
      <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
    </svg>
  </a>

  <ul class="trigger">
      
        
      
        
        <li>
            <a class="page-link" href="/zino/getting-started">Getting Started</a>
            <ul>
            
            </ul>
        </li>
        
      
        
      
        
      
        
      
        
        <li>
            <a class="page-link" href="/zino/tutorial">Tutorial</a>
            <ul>
            
                <li><a class="page-link" href="/zino/pages/tutorial/01-first-component.html">Your First Component</a></li>
            
                <li><a class="page-link" href="/zino/pages/tutorial/02-backend-communication.html">Backend Communication</a></li>
            
                <li><a class="page-link" href="/zino/pages/tutorial/03-styling-components.html">Styling Components</a></li>
            
                <li><a class="page-link" href="/zino/pages/tutorial/04-component-lifecycle.html">Component Lifecycle</a></li>
            
                <li><a class="page-link" href="/zino/pages/tutorial/05-best-practices.html">Component Best-practices</a></li>
            
            </ul>
        </li>
        
      
        
        <li>
            <a class="page-link" href="/zino/api">API</a>
            <ul>
            
                <li><a class="page-link" href="/zino/pages/api/01-zino-api.html">Zino API</a></li>
            
                <li><a class="page-link" href="/zino/pages/api/02-component-api.html">Component API</a></li>
            
            </ul>
        </li>
        
      
        
      
        
      
        
        <li>
            <a class="page-link" href="/zino/templates">Templating</a>
            <ul>
            
                <li><a class="page-link" href="/zino/templates#variables">Variables</a></li>
            
                <li><a class="page-link" href="/zino/templates#sections--conditions--iterations">Conditions/Iterations</a></li>
            
                <li><a class="page-link" href="/zino/templates#inverted-sections">Inverted Sections</a></li>
            
                <li><a class="page-link" href="/zino/templates#section-keys">Section Keys</a></li>
            
                <li><a class="page-link" href="/zino/templates#style-tag">Style Tag</a></li>
            
                <li><a class="page-link" href="/zino/templates#transfer-tag">Transfer Tag</a></li>
            
            </ul>
        </li>
        
      
        
      
        
        <li>
            <a class="page-link" href="/zino/testing">Testing</a>
            <ul>
            
            </ul>
        </li>
        
      
        
        <li>
            <a class="page-link" href="/zino/events">Events</a>
            <ul>
            
            </ul>
        </li>
        
      
        
      
        
      
        
      
        
      
  </ul>

  <hr>

  <ul class="trigger">
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  </ul>

  <a href="https://github.com/AndCake/zino">View the Project on GitHub</a>

</nav>
</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Testing</h1>
  </header>

  <div class="post-content">
    <p>Zino offers snapshot testing for making sure that tests can be written very easily and tested equally quickly. Consider this simple <a href="https://github.com/AndCake/zino/blob/master/test/components/btn.html">button link example</a>:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'zino/test'</span><span class="p">);</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">'btn link component'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">z</span><span class="p">.</span><span class="nx">importTag</span><span class="p">(</span><span class="s1">'src/btn.html'</span><span class="p">);</span>

	<span class="nx">it</span><span class="p">(</span><span class="s1">'receives the URL and renders the text properly'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nx">z</span><span class="p">.</span><span class="nx">matchesSnapshot</span><span class="p">(</span><span class="s1">'&lt;btn page="https://andcake.github.io/zino"&gt;ZinoJS&lt;/btn&gt;'</span><span class="p">)</span>
	<span class="p">});</span>
<span class="p">})</span></code></pre></figure>

<p>The first time, this test is executed, Zino creates a snapshot file that looks like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;button class="special-button" type="button"&gt;
	ZinoJS
&lt;/button&gt;
{
  "data": {
    "props": {},
    "body": "ZinoJS",
    "page": "https://andcake.github.io/zino"
  },
  "events": [
    {
      "button": [
        "click = [function]changePage"
      ]
    }
  ],
  "tagName": "btn"
}
</code></pre>
</div>

<p>The snapshot artifact should be committed alongside the code changes. On subsequent runs Zino will compare the rendered output with the snapshot. If it matches, the test passes. If it doesn’t match, either the implementation changed and the snapshot can be updated by confirming that the change is intended or you found a bug in your code that should be fixed.</p>

<h2 id="installation--usage">Installation &amp; usage</h2>

<p>Testing Zino components can be done in NodeJS context after installing it via NPM:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>npm install zino</code></pre></figure>

<p>Once it is installed, in your project, create a <code class="highlighter-rouge">test/</code> directory. Place all your tests in that directory. It is recommended to use <a href="http://mochajs.org/">MochaJS</a> for your tests but any test framework will do.</p>

<p>Zino offers three methods to support your testing efforts:</p>

<ul>
  <li><code class="highlighter-rouge">importTag(&lt;pathToTag&gt;[, &lt;document&gt;])</code> - imports a Zino component into the registry so that it can be used for testing. If the second parameter, which should be a virtual DOM implementation is provided, all instances of the imported component will be rendered in that document</li>
  <li><code class="highlighter-rouge">matchesSnapshot(&lt;tagExample&gt;, &lt;data&gt;)</code> - renders the tag as if it were used in a browser and checks if a previous snapshot of it has changed</li>
  <li><code class="highlighter-rouge">clearImports()</code> - removes all imported components from memory.</li>
  <li><code class="highlighter-rouge">clearEvents()</code> - removes all custom event handlers that have been registered</li>
</ul>

<p>If you have written your JS or CSS code in an external file and embedded it via <code class="highlighter-rouge">&lt;script src="path/to/external-file.js"&gt;&lt;/script&gt;</code> / <code class="highlighter-rouge">&lt;link rel="stylesheet" href="path/to/file.css"/&gt;</code>, you should always use the compilation result coming from <a href="https://npmjs.com/package/grunt-zino">grunt-zino</a> for testing. Else the script functionality / styling won’t be applied within your test.</p>

<h3 id="testing-with-snapshots">Testing with Snapshots</h3>

<p>Since events will usually trigger state changes, these events can be simulated by calling the <code class="highlighter-rouge">matchesSnapshot()</code> method with the data parameter, which allows you to overwrite props values. For our <a href="https://github.com/AndCake/zino/blob/master/test/components/todolist.html">todolist tag</a> example, this could look like that:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">zino</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'zino/test'</span><span class="p">);</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">'todo-list'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="nx">zino</span><span class="p">.</span><span class="nx">importTag</span><span class="p">(</span><span class="s1">'examples/dist/todolist.html'</span><span class="p">);</span>

	<span class="nx">it</span><span class="p">(</span><span class="s1">'renders empty'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">zino</span><span class="p">.</span><span class="nx">matchesSnapshot</span><span class="p">(</span><span class="s1">'&lt;todo-list&gt;&lt;/todo-list&gt;'</span><span class="p">));</span>
	<span class="nx">it</span><span class="p">(</span><span class="s1">'renders todos'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="kd">let</span> <span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
			<span class="na">props</span><span class="p">:</span> <span class="p">{</span>
				<span class="na">tasks</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Task 1'</span><span class="p">]</span>
			<span class="p">}</span>
		<span class="p">};</span>
		<span class="nx">zino</span><span class="p">.</span><span class="nx">matchesSnapshot</span><span class="p">(</span><span class="s1">'&lt;todo-list&gt;&lt;/todo-list&gt;'</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
	<span class="p">});</span>
<span class="p">})</span></code></pre></figure>

<h3 id="testing-with-jsdom-or-similar">Testing with jsDOM or similar</h3>

<p>Sometimes you might want to have a little more context than a single component - e.g. to test the interactions between components. In order to do this, you can use libraries like jsDOM that simulate a DOM and have Zino render the components inside that DOM as it would on a normal page. Here is an example of how this looks like:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kr">const</span> <span class="nx">zino</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'zino/test'</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'chai'</span><span class="p">).</span><span class="nx">assert</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">JSDOM</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'jsdom'</span><span class="p">).</span><span class="nx">jsdom</span><span class="p">;</span>

<span class="nx">describe</span><span class="p">(</span><span class="s1">'comment-box'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
	<span class="c1">// prepare the JSDOM document containing the code</span>
	<span class="kr">const</span> <span class="nx">html</span> <span class="o">=</span> <span class="s1">'&lt;comment author="Bucks Bunny"&gt;I love carrots!&lt;/comment&gt;'</span><span class="p">;</span>
	<span class="kd">let</span> <span class="nb">document</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">JSDOM</span><span class="p">(</span><span class="nx">html</span><span class="p">).</span><span class="nb">window</span><span class="p">.</span><span class="nb">document</span><span class="p">;</span>

	<span class="nx">it</span><span class="p">(</span><span class="s1">'renders the comment'</span><span class="p">,</span> <span class="p">()</span> <span class="p">{</span>
		<span class="c1">// import the component used - please note the document is handed into importTag</span>
		<span class="nx">zino</span><span class="p">.</span><span class="nx">importTag</span><span class="p">(</span><span class="s1">'test/components/comment.html'</span><span class="p">,</span> <span class="nb">document</span><span class="p">);</span>

		<span class="kd">let</span> <span class="nx">comment</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'comment'</span><span class="p">);</span>
		<span class="nx">assert</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">children</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">innerHTML</span><span class="p">,</span> <span class="s1">'"Bucks Bunny"'</span><span class="p">,</span> <span class="s1">'rendered the component into the DOM'</span><span class="p">);</span>
	<span class="p">});</span>
<span class="p">});</span></code></pre></figure>

<p>Please refer to the <a href="https://github.com/AndCake/zino/blob/master/test/zino-tester.js">test/zino-tester.js</a> for more examples of how Zino tests can be used.</p>

  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">zino</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/AndCake"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">AndCake</span></a>

          </li>
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>A micro component framework - easy to learn and powerful.
</p>
      </div>
    </div>

  </div>

</footer>

<script>
    [].slice.call(document.querySelectorAll('.site-nav li')).forEach(function(li) {
        if (li.querySelector('a[href]').href === location.href) {
            li.classList.add('active');
            if (li.parentNode.parentNode.tagName === 'LI') {
                li.parentNode.parentNode.classList.add('active');
            }
        }
    });
</script>


  </body>

</html>
