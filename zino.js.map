{"version":3,"file":"zino.js","sources":["src/utils.js","src/events.js","src/vdom.js","src/core.js","src/mustacheparser.js","src/zino.js"],"sourcesContent":["/**\n * Merges all objects provided as parameters into the first parameter object\n *\n * @param  {...Object} args list of arguments\n * @return {Object}         the merged object (same as first argument)\n */\nexport function merge (target, ...args) {\n\targs.forEach(arg => {\n\t\tfor (let all in arg) {\n\t\t\tif ((typeof HTMLElement !== 'undefined' && arg instanceof HTMLElement) || typeof propDetails(arg, all).value !== 'undefined' && (!target[all] || propDetails(target, all).writable)) {\n\t\t\t\tif (all !== 'attributes') target[all] = arg[all];\n\t\t\t}\n\t\t}\n\t});\n\n\treturn target;\n}\n\nfunction propDetails(obj, attribute) {\n\treturn isObj(obj) && Object.getOwnPropertyDescriptor(obj, attribute) || {};\n}\n\n/**\n * Creates a diff of two JS objects. Includes attribute position check.\n *\n * @param  {Object} objA\tthe object to be compared\n * @param  {Object} objB \tthe object to compare with\n * @return {Object,Boolean} false if both objects are deep equal, else the values of what is different\n */\nexport function objectDiff(objA, objB) {\n\tlet result = {},\n\t\tpartialDiff;\n\n\tif (!objA) return objB || false;\n\tif (!objB) return objA || false;\n\tObject.keys(objA).forEach((key, index) => {\n\t\tif (['__vdom', 'element', 'parentNode', 'innerHTML', 'outerHTML', 'className'].indexOf(key) >= 0 || isFn(objA[key])) return;\n\t\tif (typeof objB[key] === 'undefined') {\n\t\t\tresult[key] = objA[key];\n\t\t} else if (Object.keys(objB)[index] !== key) {\n\t\t\tlet bKey = Object.keys(objB)[index];\n\t\t\tresult[bKey] = objB[bKey];\n\t\t\tresult[key] = objA[key];\n\t\t} else if (typeof objA[key] !== 'object' || typeof objB[key] !== 'object') {\n\t\t\tif (objA[key] !== objB[key]) {\n\t\t\t\tresult[key] = objB[key];\n\t\t\t}\n\t\t} else if (partialDiff = objectDiff(objA[key], objB[key])) {\n\t\t\tresult[key] = partialDiff;\n\t\t}\n\t});\n\tObject.keys(objB).forEach((key, index) => {\n\t\tif (['__vdom', 'element', 'parentNode', 'innerHTML', 'outerHTML', 'className'].indexOf(key) >= 0 || isFn(objB[key])) return;\n\t\tif (typeof objA[key] === 'undefined') {\n\t\t\tresult[key] = objB[key];\n\t\t}\n\t});\n\tif (Object.keys(result).length > 0) return result;\n\treturn false;\n}\n\nexport function error(method, tag, parentException) {\n\tif (!parentException) {\n\t\tparentException = tag;\n\t}\n\tparentException.message = 'Error while calling ' + method + (parentException !== tag ? ' function of ' + tag : '') + ': ' + (parentException.message || parentException);\n\tthrow parentException;\n}\n\n/**\n * Checks if the given arguments are the provided types, if they do no match, an exception is thrown.\n *\n * @param  {Array} args \tlist of arguments provided to callee\n * @param  {Array} types \tlist of data types expected for the provided arguments\n * @param  {String} api  \tname of the API (callee name)\n */\nexport function checkParams(args, types, api) {\n\tfor (var all in args) {\n\t\tif (types[all] && typeof args[all] !== types[all]) {\n\t\t\tthrow new Error('API mismatch while using ' + api + ': Parameter ' + all + ' was supposed to be ' + types[all] + ' but ' + (typeof args[all]) + ' was given.');\n\t\t}\n\t}\n}\n\n/**\n * makes sure that accessing attributes on an unknown data value is safe\n *\n * @param  {Mixed} obj \tdata to made safe for attribute access\n * @return {Object}     will always return an object\n */\nexport function safeAccess(obj) {\n\treturn obj || {};\n}\n\nexport function uuid() {\n\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n\t\tlet r = Math.random() * 16 | 0;\n\t\treturn (c == 'x' ? r : r & 0x3 | 0x8).toString(16);\n\t});\n}\nexport var isObj = obj => typeof obj === 'object';\nexport var isFn = fn => typeof fn === 'function';\nexport var emptyFunc = () => {};\nexport var identity = a => a;\n\nexport function isValue(obj, key) {\n\tlet descriptor = Object.getOwnPropertyDescriptor(obj, key);\n\treturn typeof descriptor.value !== 'undefined' && !isFn(descriptor.value);\n}\n","import {isFn} from './utils';\n\nlet eventQueue = {};\n\nfunction publishEvent(type, data) {\n\tdata.name.indexOf('--event-') && trigger('--event-' + type, data);\n}\n\nexport function trigger(name, data) {\n\tif (!eventQueue[name]) return;\n\tfor (let index in eventQueue[name]) {\n\t\tpublishEvent('trigger', {name, fn: eventQueue[name][index], data});\n\t\tlet result = eventQueue[name][index](data);\n\t\tif (result === false) break;\n\t}\n}\n\nexport function on(name, fn) {\n\tif (!eventQueue[name]) {\n\t\teventQueue[name] = [];\n\t}\n\teventQueue[name].push(fn);\n\tpublishEvent('register', {name, fn});\n}\n\nexport function off(name, fn) {\n\tif (!isFn(fn)) {\n\t\tdelete eventQueue[name];\n\t\treturn publishEvent('unregister', {name});\n\t}\n\tfor (let index in eventQueue[name]) {\n\t\tif (eventQueue[name][index] === fn) {\n\t\t\tdelete eventQueue[name][index];\n\t\t\treturn publishEvent('unregister', {name, fn});\n\t\t}\n\t}\n}\n\nexport function one(name, fn) {\n\ton(name, function self() {\n\t\tfn.apply(this, arguments);\n\t\toff(name, self);\n\t});\n}\n\nexport function attachEvent (el, events, host) {\n\tif (!isFn(el.addEventListener)) return;\n\tlet findEl = (selector, target) => {\n\t\tlet node = [].slice.call(el.querySelectorAll(selector));\n\t\twhile (node.length > 0 && target !== host) {\n\t\t\tif (node.indexOf(target) >= 0) return node[node.indexOf(target)];\n\t\t\ttarget = target.parentNode;\n\t\t}\n\t\treturn false;\n\t};\n\tevents.forEach(eventObj => {\n\t\tObject.keys(eventObj.handlers).forEach(event => {\n\t\t\tel.addEventListener(event, e => {\n\t\t\t\tlet target;\n\t\t\t\tif (eventObj.selector === ':host' || (target = findEl(eventObj.selector, e.target))) {\n\t\t\t\t\ttarget && (target.getHost = () => host.getHost());\n\t\t\t\t\teventObj.handlers[event].call(target || host, e);\n\t\t\t\t}\n\t\t\t}, false);\n\t\t});\n\t});\n}\n","import {uuid} from './utils';\nimport {trigger} from './events';\n\nlet tagFilter = [];\nlet tagsCreated = [];\nlet dataResolver = (attr, value) => {\n\treturn attr;\n};\n\nfunction isArray(obj) {\n\treturn Object.prototype.toString.call(obj) === '[object Array]';\n}\n\nexport function setDataResolver(resolver) {\n\tdataResolver = resolver;\n}\n\nexport function Tag(tagName, attributes, children) {\n\ttagName = tagName.toLowerCase();\n\tattributes = attributes || {};\n\tObject.keys(attributes).forEach(attr => {\n\t\tattributes[attr] = {name: attr, value: attributes[attr]};\n\t});\n\tchildren = children && (typeof children !== 'object' || children.tagName) ? [children] : children || [];\n\tlet tag = {\n\t\ttagName,\n\t\tattributes,\n\t\tchildren: children,\n\t\t__complexity: children.reduce(((a, b) => a + (b.__complexity || 1)), 0) + children.length\n\t};\n\tif (tagFilter.indexOf(tagName) >= 0) tagsCreated.push(tag);\n\treturn tag;\n}\n\n/**\n * Returns all tags with a given tag name. If the provided context contains a getElementsByTagName() function,\n * that will be used to retrieve the data, else a manual recursive lookup will be done\n *\n * @param  {String} name - name of the tag to retrieve the elements  of\n * @param  {Object} dom - either a VDOM node or a DOM node\n * @return {Array} - list of elements that match the provided tag name\n */\nexport function getElementsByTagName(name, dom) {\n\tlet result = [];\n\tname = (name || '').toLowerCase();\n\tif (typeof dom.getElementsByTagName === 'function') return [].slice.call(dom.getElementsByTagName(name));\n\n\tif (dom.children) {\n\t\tresult = result.concat(dom.children.filter(child => child.tagName && child.tagName.toLowerCase() === name));\n\t\tdom.children.forEach(child => {\n\t\t\tresult = result.concat(getElementsByTagName(name, child));\n\t\t});\n\t}\n\treturn result;\n}\n\n/**\n * defines which VDOM nodes should be captured for getTagsCreated()\n * @param {Array} filter - an array of strings representing the tag names of the tags to be captured\n */\nexport function setFilter(filter) {\n\ttagFilter = filter;\n}\n\n/**\n * retrieves the list of tags that have been created since the last call of getTagsCreated()\n * @return {Array} - an array of VDOM nodes that were created\n */\nexport function clearTagsCreated() {\n\ttagsCreated = [];\n}\n\n/**\n * retrieves the list of tags that have been created since the last call of getTagsCreated()\n * @return {Array} - an array of VDOM nodes that were created\n */\nexport function getTagsCreated() {\n\tlet created = tagsCreated;\n\treturn created;\n}\n\n/**\n * Calculates the HTML structure as a String represented by the VDOM\n *\n * @param  {Object} node - the VDOM node whose inner HTML to generate\n * @return {String} - the HTML structure representing the VDOM\n */\nexport function getInnerHTML(node) {\n\tif (!node.children) return '';\n\tif (!isArray(node.children)) node.children = [node.children];\n\n\treturn (isArray(node) && node || node.children).map(child => {\n\t\tif (typeof child !== 'object') {\n\t\t\treturn '' + child;\n\t\t} else if (isArray(child)) {\n\t\t\treturn getInnerHTML(child);\n\t\t} else {\n\t\t\tlet attributes = [''].concat(Object.keys(child.attributes).map(attr => {\n\t\t\t\tif (typeof child.attributes[attr].value === 'object') {\n\t\t\t\t\treturn attr + '=\"--' + dataResolver(attr, child.attributes[attr].value) + '--\"';\n\t\t\t\t} else {\n\t\t\t\t\treturn attr+'=\"' + child.attributes[attr].value + '\"';\n\t\t\t\t}\n\t\t\t}));\n\t\t\treturn `<${child.tagName}${attributes.join(' ')}>${getInnerHTML(child)}</${child.tagName}>`;\n\t\t}\n\t}).join('');\n}\n\n/**\n * Creates a new DOM node\n *\n * @param  {Object|String} node - a VDOM node\n * @param  {Document} document - the document in which to create the DOM node\n * @return {Node} - the DOM node created (either a text element or an HTML element)\n */\nfunction createElement(node, document) {\n\tlet tag;\n\tif (typeof node !== 'object') {\n\t\t// we have a text node, so create one\n\t\ttag = document.createTextNode('' + node);\n\t} else {\n\t\ttag = document.createElement(node.tagName);\n\t\t// add all required attributes\n\t\tObject.keys(node.attributes).forEach((attr) => {\n\t\t\ttag.setAttribute(attr, node.attributes[attr].value);\n\t\t});\n\t\tif (node.__vdom) {\n\t\t\t// it's a component, so don't forget to initialize this new instance\n\t\t\ttrigger('--zino-initialize-node', {tag, node: node.functions});\n\t\t}\n\t\t// define it's inner structure\n\t\ttag.innerHTML = getInnerHTML(node);\n\t}\n\n\treturn tag;\n}\n\nfunction applyText(domChild, dom, node, document) {\n\t// simply apply the value\n\tif (node.match(/<[\\w:_-]+[^>]*>/)) {\n\t\tif (dom.childNodes.length === 1) {\n\t\t\tdom.innerHTML = node;\n\t\t} else {\n\t\t\tlet html = document.createElement('span');\n\t\t\thtml.innerHTML = node;\n\t\t\tdom.replaceChild(html, domChild);\n\t\t}\n\t} else {\n\t\t// it's just a text node, so simply replace the element with the text node\n\t\tdom.replaceChild(createElement(node.replace(/&quot;/g, '\"').replace(/&lt;/g, '<').replace(/&gt;/g, '>').replace(/&amp;/g, '&'), document), domChild);\n\t}\t\n}\n\n/**\n * Applies a VDOM to an actual DOM, meaning that the state of the VDOM will be recreated on the DOM.\n * The end result is, that the DOM structure is the same as the VDOM structure. Existing elements will\n * be repurposed, new elements created where necessary.\n *\n * @param  {DOM} dom - the DOM to which the VDOM should be applied\n * @param  {Object} vdom - the VDOM to apply to the DOM\n * @param  {Document} document - the document that the DOM is based on, used for createElement() and createTextNode() calls\n */\nexport function applyDOM(dom, vdom, document) {\n\tif (!isArray(vdom)) {\n\t\t// if we have a node\n\t\tif (!isArray(vdom.children)) vdom.children = [vdom.children];\n\t\t// if the tag name is not the same\n\t\tif (vdom.tagName !== dom.tagName.toLowerCase()) {\n\t\t\t// replace the node entirely\n\t\t\tdom.parentNode.replaceChild(createElement(vdom, document), dom);\n\t\t} else {\n\t\t\t// check all vdom attributes\n\t\t\tObject.keys(vdom.attributes).forEach(attr => {\n\t\t\t\t// if the VDOM attribute is a non-object\n\t\t\t\tif (typeof vdom.attributes[attr].value !== 'object') {\n\t\t\t\t\t// check if it differs\n\t\t\t\t\tif (dom.getAttribute(attr) != vdom.attributes[attr].value) {\n\t\t\t\t\t\t// if so, apply it\n\t\t\t\t\t\tdom.setAttribute(attr, vdom.attributes[attr].value);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// the attribute is an object\n\t\t\t\t\tif (dom.getAttribute(attr) && dom.getAttribute(attr).match(/^--|--$/g)) {\n\t\t\t\t\t\t// if it has a complex value, use the data resolver to define it on the DOM\n\t\t\t\t\t\tlet id = dataResolver(attr, vdom.attributes[attr].value, dom.getAttribute(attr).replace(/^--|--$/g, ''));\n\t\t\t\t\t\t// only set the ID with markers so that we know it is supposed to be a complex value\n\t\t\t\t\t\tdom.setAttribute(attr, `--${id}--`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t// if we have too many attributes in our DOM\n\t\t\tif (dom.attributes.length > Object.keys(vdom.attributes)) {\n\t\t\t\t[].forEach.call(dom.attributes, attr => {\n\t\t\t\t\t// if the respective attribute does not exist on the VDOM\n\t\t\t\t\tif (typeof vdom.attributes[attr.name] === 'undefined') {\n\t\t\t\t\t\t// remove it\n\t\t\t\t\t\tdom.removeAttribute(attr.name);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\t// deal with the vdom's children\n\tlet children = (isArray(vdom) ? vdom : vdom.children);\n\tchildren.forEach((node, index) => {\n\t\tif (isArray(node)) return applyDOM(dom, node, document);\n\t\tlet domChild = dom.childNodes[index];\n\t\tif (typeof domChild === 'undefined') {\n\t\t\t// does not exist, so it needs to be appended\n\t\t\tdom.appendChild(createElement(node, document));\n\t\t} else if (domChild.nodeType === 3) {\n\t\t\t// is a text node\n\t\t\t// if the VDOM node is also a text node\n\t\t\tif (typeof node === 'string' && domChild.nodeValue !== node) {\n\t\t\t\tapplyText(domChild, dom, node, document);\n\t\t\t} else if (typeof node !== 'string') {\n\t\t\t\t// else replace with a new element\n\t\t\t\tdom.replaceChild(createElement(node, document), domChild);\n\t\t\t}\n\t\t} else if (domChild.nodeType === 1) {\n\t\t\t// is a normal HTML tag\n\t\t\tif (typeof node === 'object') {\n\t\t\t\t// the VDOM is also a tag, apply it recursively\n\t\t\t\tapplyDOM(domChild, node, document);\n\t\t\t} else {\n\t\t\t\tapplyText(domChild, dom, node, document);\n\t\t\t}\n\t\t}\n\t});\n\tif (dom.childNodes.length > children.length) {\n\t\t// remove superfluous child nodes\n\t\t[].slice.call(dom.childNodes, children.length).forEach(child => dom.removeChild(child));\n\t}\n}\n","import * as vdom from './vdom';\nimport {emptyFunc, isFn, isObj, uuid, merge} from './utils';\nimport {trigger, on, attachEvent} from './events';\n\nexport let renderOptions = {\n\tresolveData(key, value, oldID) {\n\t\tlet id = uuid();\n\t\tif (oldID) {\n\t\t\t// unregister old entry\n\t\t\tdelete dataRegistry[oldID];\n\t\t}\n\t\tdataRegistry[id] = value;\n\t\treturn id;\n\t}\n};\n\nlet tagRegistry = {},\n\tdataRegistry = {},\n\tdefaultFunctions = {\n\t\t'props': {},\n\t\t'mount': emptyFunc,\n\t\t'unmount': emptyFunc,\n\t\t'render': emptyFunc,\n\n\t\tgetHost() { return this; },\n\t\tsetProps(name, value) {\n\t\t\tlet tag = this.getHost();\n\t\t\tif (isObj(name)) {\n\t\t\t\tmerge(tag.props, name);\n\t\t\t} else {\n\t\t\t\ttag.props[name] = value;\n\t\t\t\tlet attrName = 'data-' + name.replace(/[A-Z]/g, g => `-${g.toLowerCase()}`);\n\t\t\t\tif (tag.attributes[attrName]) {\n\t\t\t\t\tdefineAttribute(tag, attrName, `--${renderOptions.resolveData(name, value, tag.attributes[attrName].value)}--`);\n\t\t\t\t}\n\t\t\t}\n\t\t\t!tag.mounting && trigger('--zino-rerender-tag', tag);\n\t\t}\n\t};\n\nexport function registerTag(fn, document, Zino) {\n\tlet firstElement = fn(vdom.Tag, Zino),\n\t\ttagName = firstElement.tagName;\n\n\tif (tagRegistry[tagName]) {\n\t\t// tag is already registered\n\t\treturn;\n\t}\n\n\thandleStyles(firstElement);\n\tfirstElement.functions = merge({}, defaultFunctions, firstElement.functions);\n\ttagRegistry[tagName] = firstElement;\n\n\t// initialize all occurences in provided context\n\tdocument && [].slice.call(vdom.getElementsByTagName(tagName, document)).forEach(tag => initializeTag(tag, tagRegistry[tagName]));\n}\n\nexport function mount(tag, ignoreRender) {\n\tif (!tag.tagName) return;\n\tlet entry = tagRegistry[tag.tagName.toLowerCase()];\n\tif (!entry || tag.getAttribute('__ready')) return;\n\tif (ignoreRender) entry.functions.render = emptyFunc;\n\treturn initializeTag.call(ignoreRender ? {noEvents: true} : this, tag, entry);\n}\n\nexport function render(tag) {\n\tlet subEvents = renderTag(tag);\n\tattachSubEvents(subEvents, tag);\n}\n\nexport function flushRegisteredTags() {\n\ttagRegistry = {};\n}\n\nfunction initializeTag(tag, registryEntry) {\n\t// check if the tag has been initialized already\n\tif (tag.__vdom || !registryEntry) return;\n\tlet functions = registryEntry.functions;\n\n\t// if it has been pre-rendered\n\tif (tag.children.length > 0 && tag.children[0].attributes && tag.children[0].attributes['class'] && tag.children[0].attributes['class'].value === '-shadow-root') {\n\t\tlet sibling = tag.children[1];\n\t\t// remove original HTML content\n\t\tif (sibling && sibling.className === '-original-root') {\n\t\t\ttag.__i = sibling.innerHTML;\n\t\t\tsetElementAttr(sibling, tag);\n\t\t\tsibling.parentNode.removeChild(sibling);\n\t\t}\n\t\ttag.isRendered = true;\n\t} else {\n\t\ttag.__i = tag.ownerDocument ? tag.innerHTML : vdom.getInnerHTML(tag);\n\t\tsetElementAttr(tag);\n\t\ttag.innerHTML = '<div class=\"-shadow-root\"></div>';\n\t\ttag.isRendered = false;\n\t}\n\ttrigger('--zino-initialize-node', {tag, node: functions});\n\ttag.__vdom = {};\n\n\t// render the tag's content\n\tlet subEvents = !tag.isRendered && renderTag.call(this, tag) || {events:[]};\n\t\n\t// attach events\n\tlet hostEvents = [],\n\t\tevents = functions.events || [],\n\t\tchildEvents = Object.keys(events).filter(all => {\n\t\t\tlet isNotSelf = all !== ':host' && all !== tag.tagName;\n\t\t\tif (!isNotSelf) hostEvents.push({handlers: events[all], selector: all});\n\t\t\treturn isNotSelf;\n\t\t}).map(e => ({selector: e, handlers: events[e]}));\n\n\tsubEvents.events = subEvents.events.concat({childEvents, hostEvents, tag: this && this.noEvents ? tag.tagName : tag})\n\n\tif (!tag.attributes.__ready) {\n\t\tdefineAttribute(tag, '__ready', true);\n\t}\n\tif (!this || this.noEvents !== true) {\n\t\t// attach sub events\n\t\tattachSubEvents(subEvents, tag);\n\t} else {\n\t\treturn subEvents;\n\t}\n}\n\nfunction defineAttribute(tag, name, value) { \n\t// if __s is already defined (which means the component has been mounted already) \n\tif (isFn(tag.__s)) { \n\t\t// if it's the same as setAttribute \n\t\tif (tag.__s === tag.setAttribute) { \n\t\t\t// we might have a double override => use the original HTMLElement's setAttribute instead to avoid endless recursion \n\t\t\tHTMLElement.prototype.setAttribute.call(tag, name, value); \n\t\t} else { \n\t\t\t// we now know it's the original setAttribute (also works for vdom nodes) \n\t\t\ttag.__s(name, value); \n\t\t} \n\t} else { \n\t\t// if the element is not a mounted component \n\t\t// but it is a regular HTML element \n\t\tif (tag.ownerDocument) { \n\t\t\t// use the HTMLElement's setAttribute to define the attribute \n\t\t\tHTMLElement.prototype.setAttribute.call(tag, name, value); \n\t\t} else { \n\t\t\t// we now know it can only be a vdom node, so set attribute vdom-style \n\t\t\ttag.attributes[name] = {name, value}; \n\t\t} \n\t} \n} \n\nfunction initializeNode({tag, node: functions = defaultFunctions}) {\n\t// copy all defined functions/attributes\n\tfor (let all in functions) {\n\t\tlet entry = functions[all];\n\t\tif (['mount', 'unmount', 'events', 'render'].indexOf(all) < 0) {\n\t\t\tif (isFn(entry)) {\n\t\t\t\ttag[all] = entry.bind(tag);\n\t\t\t} else {\n\t\t\t\ttag[all] = isObj(tag[all]) ? merge({}, entry, tag[all]) : entry;\n\t\t\t}\n\t\t}\n\t}\n\t// define basic properties\n\tlet desc = Object.getOwnPropertyDescriptor(tag, 'body');\n\tif (!desc || typeof desc.get === 'undefined') {\n\t\tObject.defineProperty(tag, 'body', {\n\t\t\tset(val) {\n\t\t\t\ttag.__i = val;\n\t\t\t\tsetElementAttr(tag);\n\t\t\t\ttrigger('--zino-rerender-tag', tag.getHost());\n\t\t\t},\n\t\t\tget() { return tag.__i; }\n\t\t});\n\t}\n\ttag.__s = tag.setAttribute;\n\ttag.setAttribute = function(attr, val) {\n\t\tdefineAttribute(this, attr, val);\n\t\ttrigger('--zino-rerender-tag', this);\n\t};\n\n\t// call mount callback\n\ttag.props = merge({}, functions.props, getAttributes(tag, true));\n\ttag.attrs = getAttributes(tag);\n\n\ttry {\n\t\ttag.mounting = true;\n\t\tfunctions.mount.call(tag);\n\t\tdelete tag.mounting;\n\t} catch (e) {\n\t\tthrow new Error('Unable to call mount function for ' + tag.tagName + ': ' + (e.message || e));\n\t}\n}\n\nfunction renderTag(tag, registryEntry = tagRegistry[tag.tagName.toLowerCase()]) {\n\tlet events = [],\n\t\trenderCallbacks = [],\n\t\trenderedSubElements = [],\n\t\trenderedDOM;\n\n\t// do the actual rendering of the component\n\tvdom.setDataResolver(renderOptions.resolveData);\n\tvdom.clearTagsCreated();\n\tlet data = getAttributes(tag);\n\tif (isFn(registryEntry.render)) {\n\t\t// tell the vdom which tags to remember to look for\n\t\tvdom.setFilter(Object.keys(tagRegistry));\n\t\trenderedDOM = vdom.Tag('div', {'class': '-shadow-root'}, registryEntry.render.call(tag, data));\n\t} else {\n\t\tthrow new Error('No render function provided in component ' + tag.tagName);\n\t}\n\n\t// unmount previously rendered sub components\n\ttag.__subs && tag.__subs.forEach(unmountTag);\n\n\t// render all contained sub components\n\t// retrieve the tags that the vdom was made aware of (all our registered components)\n\trenderedSubElements = vdom.getTagsCreated();\n\tfor (let idx = 0, len = renderedSubElements.length; idx < len; idx += 1) {\n\t\tlet subEl = renderedSubElements[idx];\n\n\t\t// initialize them all\n\t\tlet subElEvents = initializeTag.call({\n\t\t\tnoRenderCallback: true,\n\t\t\tnoEvents: true\n\t\t}, subEl, tagRegistry[subEl.tagName]);\n\t\tif (subElEvents) {\n\t\t\t// make sure that we build the hierarchical order of sub elements (same as what comes back from querySelectorAll)\n\t\t\trenderedSubElements.splice.apply(renderedSubElements, [idx + 1, 0].concat(subElEvents.subElements));\n\t\t\t// array has been extended, adapt...\n\t\t\tidx += subElEvents.subElements.length;\n\t\t\tlen += subElEvents.subElements.length;\n\t\t\tevents = events.concat(subElEvents.events);\n\t\t\trenderCallbacks = renderCallbacks.concat(subElEvents.renderCallbacks);\n\t\t}\n\t}\n\n\tif (tag.attributes.__ready && (Math.abs(renderedDOM.__complexity - (tag.__complexity || 0)) < 50) && tag.ownerDocument) {\n\t\t// has been rendered before, so just apply diff\n\t\tvdom.applyDOM(tag.children[0], renderedDOM, tag.ownerDocument);\n\t} else {\n\t\t// simply render everything inside\n\t\tif (tag.ownerDocument) {\n\t\t\ttag.children[0].innerHTML = vdom.getInnerHTML(renderedDOM);\n\t\t} else {\n\t\t\ttag.children[0] = renderedDOM;\n\t\t}\n\t}\n\ttag.__subs = renderedSubElements;\n\ttag.__vdom = renderedDOM;\n\ttag.__complexity = renderedDOM.__complexity;\n\n\t// if we have rendered any sub components, retrieve their actual DOM node\n\trenderedSubElements.length > 0 && (tag.querySelectorAll && [].slice.call(tag.querySelectorAll('[__ready]')) || []).forEach((subEl, index) => {\n\t\t// apply all additional functionality to them (custom functions, attributes, etc...)\n\t\tmerge(subEl, renderedSubElements[index]);\n\t\t// update getHost to return the DOM node instead of the vdom node\n\t\tsubEl.getHost = renderedSubElements[index].getHost = defaultFunctions.getHost.bind(subEl);\n\t});\n\ttag.isRendered = true;\n\n\t// if this is not a sub component's rendering run\n\tif (!this || !this.noRenderCallback) {\n\t\t// call all of our sub component's render functions\n\t\trenderCallbacks.forEach(callback => callback.fn.call(callback.tag.getHost()));\n\t\t// call our own rendering function\n\t\tregistryEntry.functions.render.call(tag);\n\t} else {\n\t\t// just add this sub component's rendering function to the list\n\t\trenderCallbacks.push({fn: registryEntry.functions.render, tag});\n\t}\n\treturn {events, renderCallbacks, data, subElements: renderedSubElements};\n}\n\nfunction attachSubEvents(subEvents, tag) {\n\tvar count = {};\n\t// make sure that we only attach events if we are actually in browser context\n\tif (tag.addEventListener.toString().indexOf('[native code]') >= 0) {\n\t\tsubEvents.events.forEach(event => {\n\t\t\tlet el = event.tag;\n\t\t\tif (!isObj(el)) {\n\t\t\t\t// we have a selector rather than an element\n\t\t\t\tcount[el] = (count[el] || 0) + 1;\n\t\t\t\t// turn the selector into the corresponding element\n\t\t\t\tel = tag.querySelectorAll(el)[count[el] - 1];\n\t\t\t}\n\t\t\t// if no events have been attached yet\n\t\t\tif (!el.children[0].__eventsAttached) {\n\t\t\t\t// attach children tag events to the shadow root\n\t\t\t\tattachEvent(el.children[0], event.childEvents, el);\n\t\t\t\t// attach host events directly to the component\n\t\t\t\tattachEvent(el, event.hostEvents, el);\n\t\t\t\tel.children[0].__eventsAttached = true;\n\t\t\t}\n\t\t});\n\t}\n\t[tag].concat(tag.__subs).forEach(function(el) {\n\t\tlet actual = el && el.getHost() || {};\n\t\tisFn(actual.onready) && actual.onready.call(actual);\n\t});\n}\n\nfunction unmountTag(tag) {\n\tlet name = (tag.tagName || '').toLowerCase(),\n\t\tentry = tagRegistry[name];\n\tif (entry) {\n\t\t[].forEach.call(tag.nodeType === 1 && tag.attributes || Object.keys(tag.attributes).map(attr => tag.attributes[attr]), attr => {\n\t\t\t// cleanup saved data\n\t\t\tif (attr.name.indexOf('data-') >= 0) {\n\t\t\t\tdelete dataRegistry[attr.value];\n\t\t\t}\n\t\t});\n\t\ttry {\n\t\t\tentry.functions.unmount.call(tag);\n\t\t} catch (e) {\n\t\t\tthrow new Error('Unable to unmount tag ' + name + ': ' + (e.message || e));\n\t\t}\n\t}\n}\n\nfunction getAttributes(tag, propsOnly) {\n\tlet attrs = {props: tag.props, element: tag.element, styles: tag.styles, body: tag.__i},\n\t\tprops = attrs.props;\n\n\t[].forEach.call(tag.nodeType === 1 && tag.attributes || Object.keys(tag.attributes).map(attr => tag.attributes[attr]), attribute => {\n\t\tlet isComplex = attribute.name.indexOf('data-') >= 0 && typeof attribute.value === 'string' && attribute.value.substr(0, 2) === '--';\n\t\tlet value = attribute.value;\n\t\tattrs[attribute.name] || (attrs[attribute.name] = isComplex && typeof value === 'string' && dataRegistry[value.replace(/^--|--$/g, '')] || value);\n\t\tif (attribute.name.indexOf('data-') === 0) {\n\t\t\tprops[attribute.name.replace(/^data-/g, '').replace(/(\\w)-(\\w)/g, (g, m1, m2) => m1 + m2.toUpperCase())] = attrs[attribute.name];\n\t\t}\n\t});\n\n\tif (propsOnly) return props;\n\treturn attrs;\n}\n\nfunction setElementAttr(source, target = source) {\n\tlet baseAttrs = {};\n\t[].forEach.call(source.children, el => {\n\t\tif (!el.tagName) return;\n\t\tlet name = el.tagName.toLowerCase();\n\t\tif (baseAttrs[name]) {\n\t\t\tif (!baseAttrs[name].isArray) {\n\t\t\t\tbaseAttrs[name] = [baseAttrs[name]];\n\t\t\t\tbaseAttrs[name].isArray = true;\n\t\t\t}\n\t\t\tbaseAttrs[name].push(el);\n\t\t} else {\n\t\t\tbaseAttrs[name] = el;\n\t\t}\n\t});\n\ttarget.element = baseAttrs;\n}\n\nfunction handleStyles(element) {\n\tlet tagName = element.tagName;\n\tlet styles = (element.styles || []).map(style => {\n\t\t\tlet code = style;\n\t\t\treturn code.replace(/[\\r\\n]*([^%\\{;\\}]+?)\\{/gm, (global, match) => {\n\t\t\t\tif (match.trim().match(/^@/)) {\n\t\t\t\t\treturn match + '{';\n\t\t\t\t}\n\t\t\t\tvar selectors = match.split(',').map(selector => {\n\t\t\t\t\tselector = selector.trim();\n\t\t\t\t\tif (selector.match(/:host\\b/) ||\n\t\t\t\t\t\tselector.match(new RegExp(`^\\\\s*${tagName}\\\\b`)) ||\n\t\t\t\t\t\tselector.match(/^\\s*(?:(?:\\d+%)|(?:from)|(?:to)|(?:@\\w+)|\\})\\s*$/)) {\n\t\t\t\t\t\treturn selector;\n\t\t\t\t\t}\n\t\t\t\t\treturn tagName + ' ' + selector;\n\t\t\t\t});\n\t\t\t\treturn global.replace(match, selectors.join(','));\n\t\t\t}).replace(/:host\\b/gm, tagName) + '\\n';\n\t\t}).join('\\n');\n\ttrigger('publish-style', {styles, tagName});\n}\n\non('--zino-initialize-node', initializeNode);\non('--zino-unmount-tag', unmountTag);\non('--zino-mount-tag', mount);\n","import {trigger, on, off} from './events';\n\nconst tagRegExp = /<(\\/?)([\\w-]+)([^>]*?)(\\/?)>/g;\nconst attrRegExp = /([\\w_-]+)(?:=(?:'([^']*?)'|\"([^\"]*?)\"))?/g;\nconst commentRegExp = /<!--(?:[^-]|-[^-])*-->/g;\nconst syntax = /\\{\\{\\s*([^\\}]+)\\s*\\}\\}\\}?/g;\n\n/* helper functions to be used inside the generated code */\n\n/** @function safeAccess\n * safely access the given property in the object obj.\n * \n * @param obj (Object) - the object to read the property from\n * @param attrs (String) - the name of the property to access (allows for object paths via ., e.g. \"myprop.firstValue\")\n * @param escape (Boolean) - if the value should be HTML escaped to prevent XSS attacks and such\n * @return any\n */\nconst safeAccess = 'function safeAccess(t,e,r){if(!e)return t;if(\".\"===e[0])return t[e];for(e=e.split(\".\");e.length>0&&void 0!==(t=t[e.shift()]););return\"string\"==typeof t&&r===!0?t.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/\"/g,\"&quot;\").replace(/>/g,\"&gt;\"):\"function\"==typeof t?t.call(__i):\"number\"==typeof t?t:t||\"\"}'/*`function safeAccess(obj, attrs, escape) {\n\tif (!attrs) return obj;\n\tif (attrs[0] === '.') {\n\t\treturn obj[attrs];\n\t}\n\tattrs = attrs.split('.');\n\twhile (attrs.length > 0 && typeof (obj = obj[attrs.shift()]) !== 'undefined');\n\tif (typeof obj === 'string' && escape === true) {\n\t\treturn obj.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\"/g, '&quot;').replace(/>/g, '&gt;');\n\t} else if (typeof obj === 'function') {\n\t\treturn obj.call(instance);\n\t} else {\n\t\treturn typeof obj === 'number' ? obj : (obj || '');\n\t}\n}`*/;\n\n/** @function toArray\n * turn property value of an object into an array\n * \n * @param data (Object) - the object to read the property value from\n * @param value (String) - the property whose value should be read from the object\n * @return Array\n */\nconst toArray = 'function toArray(t,e){var r=safeAccess(t,e);return r?\"[object Array]\"===Object.prototype.toString.call(r)?r:\"function\"==typeof r?r():[r]:[]}'/*`function toArray(data, value) {\n\tvar dataValue = safeAccess(data, value);\n\tif (dataValue) {\n\t\tif (Object.prototype.toString.call(dataValue) === '[object Array]') {\n\t\t\treturn dataValue;\n\t\t} else if (typeof dataValue === 'function') {\n\t\t\treturn dataValue();\n\t\t} else return [dataValue];\n\t} else {\n\t\treturn [];\n\t}\n}`*/;\n\n/** @function spread\n * turns an array of arrays into an array of all containing elements (reduces the array depth by 1)\n * \n * @param array (Array) - the array to spread the values along\n * @return Array - a new array containing all the values of the sub elements\n */\nconst spread = 'function spread(t){var e=[];return t.forEach(function(t){e=e.concat(t)}),e}'/*`function spread(array) {\n\tvar result = [];\n\tarray.forEach(function(entry) {\n\t\tresult = result.concat(entry);\n\t});\n\treturn result;\n}`*/;\n\n/** @function merge\n * merges any number of objects into the target object\n * @param target (Object) - the object the other object should be merged into\n * @param obj1 (Object) - the first object to be merged into the target object\n * @param objn (Object) - all nth object to be merged into the target object\n * @return Object - the target object\n */\nconst merge = 'function merge(t){return[].slice.call(arguments,1).forEach(function(e){for(var r in e)t[r]=e[r]}),t}'/*`function merge(target) {\n\t[].slice.call(arguments, 1).forEach(function (arg) {\n\t\tfor (var all in arg) {\n\t\t\ttarget[all] = arg[all];\n\t\t}\n\t});\n\n\treturn target;\n}`*/;\n\n/** @function renderStyle\n * transforms an object into CSS properties\n * \n * @param value (Object) - the object to be transformed\n * @param context (Object) - for any functions defined in the object, context will be provided within as `this`\n * @return String - the CSS property list separated by semicolon\n */\nconst renderStyle = 'function renderStyle(t,r){var e=\"\";if(transform=function(t){return\"function\"==typeof t?transform(t.apply(r)):t+(\"number\"==typeof t&&null!==t?r.styles&&r.styles.defaultUnit||\"px\":\"\")},\"object\"==typeof t)for(var n in t)e+=n.replace(/[A-Z]/g,function(t){return\"-\"+t.toLowerCase()})+\":\"+transform(t[n])+\";\";return e}'/*`function renderStyle(value, context) {\n\tvar style = '';\n\t\ttransform = function(val) {\n\t\t\tif (typeof val === 'function') return transform(val.apply(context));\n\t\t\treturn val + (typeof val === 'number' && val !== null ? context.styles && context.styles.defaultUnit || 'px' : '');\n\t\t};\n\n\tif (typeof value === 'object') {\n\t\tfor (var all in value) {\n\t\t\tstyle += all.replace(/[A-Z]/g, function(g){ return '-' + g.toLowerCase()}) + ':' + transform(value[all]) + ';';\n\t\t}\n\t}\n\n\treturn style;\n}`*/;\n\n/* this is the base structure of a Zino tag */\nconst baseCode = 'function (Tag,Zino){var __i;{{helperFunctions}};return{tagName:\"{{tagName}}\",{{styles}}render:function(data){return __i=this,[].concat({{render}})},functions:{{functions}}}}'/*`function(Tag, Zino) {\n\tvar instance = null;\n\t{{helperFunctions}}\n\n\treturn {\n\t\ttagName: '{{tagName}}',\n\t\t{{styles}}\n\t\trender: function(data) {\n\t\t\tinstance = this;\n\t\t\treturn [].concat({{render}})\n\t\t},\n\n\t\tfunctions: {{functions}}\n\t};\n}`*/;\n\n/** takes an HTML string containing mustache code and turns it into executable JS code that generates a vdom */\nexport function parse(data) {\n\tlet resultObject = {\n\t\tstyles: [],\n\t\thelperFunctions: [safeAccess],\n\t\ttagName: '',\n\t\trender: '',\n\t\tfunctions: []\n\t};\n\tlet usesMerge = false, usesRenderStyle = false, usesSpread = false;\n\tlet match, lastIndex = 0, level = 0, tagStack = [];\n\n\t// return the correct data level for multi-level mustache blocks\n\tfunction getData() {\n\t\treturn `data${level === 0 ? '' : '$' + level}`;\n\t}\n\n\t// text is the only place where mustache code can be found\n\tfunction handleText(text, isAttr) {\n\t\tlet match, result = '', lastIndex = 0;\n\t\tlet cat = isAttr ? ' + ' : ', ';\n\t\tif (!text.match(syntax)) {\n\t\t\treturn result += \"'\" + text.substr(lastIndex).replace(/\\n/g, '').replace(/'/g, '\\\\\\'') + \"'\" + cat;\n\t\t}\n\t\t// locate mustache syntax within the text\n\t\twhile (match = syntax.exec(text)) {\n\t\t\tif (match.index < lastIndex) continue;\n\t\t\tlet frag = text.substring(lastIndex, match.index).replace(/^\\s+/g, '');\n\t\t\tif (frag.length > 0) {\n\t\t\t\tresult += \"'\" + frag.replace(/\\n/g, '').replace(/'/g, '\\\\\\'') + \"'\" + cat;\n\t\t\t}\n\t\t\tlastIndex = match.index + match[0].length;\n\t\t\tlet key = match[1];\n\t\t\t// of \"{{#test}}\" value will be \"test\"\n\t\t\tlet value = key.substr(1);\n\t\t\tif (key[0] === '#') {\n\t\t\t\t// handle block start\n\t\t\t\tresult += `spread(toArray(${getData()}, '${value}').map(function (e, i, a) {\n\t\t\t\t\t\tvar data$${level + 1} = merge({}, data${0 >= level ? '' : '$' + level}, {'.': e, '.index': i, '.length': a.length}, e);\n\t\t\t\t\t\treturn [].concat(`;\n\t\t\t\tlevel += 1;\n\t\t\t\tusesMerge = true;\n\t\t\t\tusesSpread = true;\n\t\t\t} else if (key[0] === '/') {\n\t\t\t\t// handle block end\n\t\t\t\tresult += '\\'\\'); }))' + (isAttr ? '.join(\"\")' : '') + cat;\n\t\t\t\tlevel -= 1;\n\t\t\t\tif (level < 0) {\n\t\t\t\t\tthrow new Error('Unexpected end of block: ' + key.substr(1));\n\t\t\t\t}\n\t\t\t} else if (key[0] === '^') {\n\t\t\t\t// handle inverted block start\n\t\t\t\tresult += `(safeAccess(${getData()}, '${value}') && (typeof safeAccess(${getData()}, '${value}') === 'boolean' || safeAccess(${getData()}, '${value}').length > 0)) ? '' : spread([1].map(function() { var data$${level + 1} = merge({}, data${0 >= level ? '' : '$' + level}); return [].concat(`;\n\t\t\t\tusesSpread = true;\n\t\t\t\tlevel += 1;\n\t\t\t} else if (key[0] === '%') {\n\t\t\t\t// handle style rendering \"{{%myvar}}\" - only to be used for attribute values!\n\t\t\t\tresult += key.substr(1).split(/\\s*,\\s*/).map(value => `renderStyle(safeAccess(${getData()}, '${value}'), ${getData()})`).join(' + ');\n\t\t\t\tusesRenderStyle = true;\n\t\t\t} else if (key[0] === '+') {\n\t\t\t\t// handle deep data transfer \"{{+myvar}}\"\n\t\t\t\tresult += `safeAccess(${getData()}, '${value}')${cat}`;\n\t\t\t} else if (key[0] !== '{' && key[0] !== '!') {\n\t\t\t\t// handle non-escaping prints \"{{{myvar}}}\"\n\t\t\t\tvalue = key;\n\t\t\t\tresult += `''+safeAccess(${getData()}, '${value}', true)${cat}`\n\t\t\t} else if (key[0] !== '!') {\n\t\t\t\t// regular prints \"{{myvar}}\"\n\t\t\t\tresult += `''+safeAccess(${getData()}, '${value}')${cat}`;\n\t\t\t} // ignore comments\n\t\t}\n\t\tif (text.substr(lastIndex).length > 0) {\n\t\t\tresult += \"'\" + text.substr(lastIndex).replace(/\\n/g, '').replace(/'/g, '\\\\\\'') + \"'\" + cat;\n\t\t}\n\t\treturn result;\n\t}\n\n\t// generate attribute objects for vdom creation\n\tfunction makeAttributes(attrs) {\n\t\tlet attributes = '{';\n\t\tlet attr;\n\n\t\twhile ((attr = attrRegExp.exec(attrs))) {\n\t\t\tif (attributes !== '{') attributes += ', ';\n\t\t\tattributes += '\"' + attr[1].toLowerCase() + '\": ' + handleText(attr[2] || attr[3] || '', true).replace(/\\s*[,+]\\s*$/g, '');\n\t\t}\n\t\treturn attributes + '}';\n\t}\n\n \t// clean up code\n\ton('--zino-addscript', content => {\n\t\tcontent = content.trim().replace(/;$/,'').replace(/(['\"`])([^\\1\\n]*)\\1/gm, (g,m,c) => g.replace(c, c.replace(/\\/\\//g, '\\\\/\\\\/'))).replace(/\\/\\/.*$/gm, '');\n\t\tif (content.trim()) {\n\t\t\tresultObject.functions.push(content);\n\t\t\tusesMerge = true;\n\t\t}\n\t});\t \n\t// handle all scripts and styles\n\tdata = data.replace(commentRegExp, '').replace(/<(script|style)(\\s+[^>]*?)?>((?:.|\\n)*?)<\\/\\1>/gi, (g, x, a, m) => {\n\t\tif (x === 'style') {\n\t\t\tresultObject.styles.push(m);\n\t\t} else {\n\t\t\tif (a && a.match(/\\s+src=(?:(?:'([^']+)')|(?:\"([^\"]+)\"))/g)) {\n\t\t\t\ttrigger('publish-script', RegExp.$1 || RegExp.$2);\n\t\t\t} else {\n\t\t\t\ttrigger('--zino-addscript', m);\n\t\t\t}\n\t\t}\n\t\treturn '';\n\t}).trim();\n\toff('--zino-addscript');\n\n\t// check if we have an actual HTML component code (looking for the starting tag)\n\tif (!data.match(tagRegExp)) {\n\t\tthrow new Error('No proper component provided');\n\t}\n\t// find out how the component is called\n\tresultObject.tagName = data.match(/^<([\\w_-]+)>/)[1].toLowerCase();\n\n\t// loop through all HTML tags in code\n\twhile (match = tagRegExp.exec(data)) {\n\t\t// skip the ones we already processed\n\t\tif (match.index < lastIndex) continue;\n\t\tlet text = data.substring(lastIndex, match.index).replace(/^[ \\t]+|[ \\t]$/g, ' ').trim();\n\t\tlastIndex = match.index + match[0].length;\n\t\t// if we have some leading text (before the first tag)\n\t\tif (text.length > 0) {\n\t\t\t// it must be a text node\n\t\t\tresultObject.render += handleText(text);\n\t\t}\n\t\t// if we found the tag's definition, skip it\n\t\tif (match[2] === resultObject.tagName) continue;\n\t\tif (match[1]) {\n\t\t\t// closing tag\n\t\t\tlet expected = tagStack.pop();\n\t\t\tif (expected !== match[2]) {\n\t\t\t\tthrow new Error('Unexpected end of tag: ' + match[2] + '; expected to end ' + expected);\n\t\t\t}\n\t\t\tresultObject.render = resultObject.render.replace(/,\\s*$/g, '') + ')), ';\n\t\t} else {\n\t\t\t// opening tag\n\t\t\ttagStack.push(match[2]);\n\t\t\tlet attributes = makeAttributes(match[3]);\n\t\t\tresultObject.render += `new Tag('${match[2]}', ${attributes}`;\n\t\t\tif (!match[4]) {\n\t\t\t\t// not a self-closing tag, so prepare for it's content\n\t\t\t\tresultObject.render += ', [].concat(';\n\t\t\t} else {\n\t\t\t\t// self-closing tag, close it immediately\n\t\t\t\tresultObject.render += '), ';\n\t\t\t\ttagStack.pop();\n\t\t\t}\n\t\t}\n\t}\n\tif (tagStack.length > 0) {\n\t\tthrow new Error('Unclosed tags: ' + tagStack.join(', '));\n\t}\n\tif (level > 0) {\n\t\tthrow new Error('Unexpected end of block');\n\t}\n\t// if we have content after the last found tag node\n\tif (data.substr(lastIndex).trim().length > 0) {\n\t\t// it must be a text node\n\t\tresultObject.render += handleText(data.substr(lastIndex).replace(/^[ \\t]+|[ \\t]$/g, ' ').trim());\n\t}\n\tresultObject.render = resultObject.render.replace(/,\\s*$/g, '');\n\n\t// add helper functions that were used by the code\n\tif (usesMerge) {\n\t\tresultObject.helperFunctions.push(merge);\n\t\tresultObject.helperFunctions.push(toArray);\n\t}\n\tif (usesSpread) {\n\t\tresultObject.helperFunctions.push(spread);\n\t}\n\tif (usesRenderStyle) {\n\t\tresultObject.helperFunctions.push(renderStyle);\n\t}\n\tresultObject.functions = resultObject.functions.length > 0 ? 'merge({}, ' + (resultObject.functions.join(', ') || '{}') + ')' : '{}';\n\tresultObject.styles = resultObject.styles.length > 0 ? 'styles: ' + JSON.stringify(resultObject.styles) + ',' : '';\n\tresultObject.helperFunctions = resultObject.helperFunctions.join('\\n');\n\n\t// fill in place-holders in base code and return the result\n\treturn baseCode.replace(/\\{\\{([^\\}]+)\\}\\}/g, (g, m) => resultObject[m]);\n}\n","import {registerTag, render} from './core';\nimport {parse} from './mustacheparser';\nimport {emptyFunc, isObj} from './utils';\nimport {on, one, off, trigger} from './events';\n\nlet urlRegistry = window.zinoTagRegistry || {},\n\tZino,\n\tdirtyTags = [],\n\ttagObserver = new MutationObserver(records => {\n\t\trecords.forEach(record => {\n\t\t\tlet added = record.addedNodes,\n\t\t\t\tremoved = record.removedNodes;\n\n\t\t\tif (added.length > 0) {\n\t\t\t\t[].forEach.call(added, tag => trigger('--zino-mount-tag', tag));\n\t\t\t} else if (removed.length > 0) {\n\t\t\t\t[].forEach.call(removed, tag => {\n\t\t\t\t\t(tag.children && $('[__ready]', tag) || []).concat(tag).forEach(subTag => trigger('--zino-unmount-tag', subTag));\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\nfunction $(selector, context) {\n\treturn [].slice.call(context.querySelectorAll(selector));\n}\n\nexport default Zino = {\n\ton, one, off, trigger,\n\n\tfetch(url, callback, cache, code) {\n\t\tif (cache && urlRegistry[url] && !urlRegistry[url].callback) {\n\t\t\treturn callback(urlRegistry[url], 200);\n\t\t} else if (isObj(urlRegistry[url])) {\n\t\t\treturn urlRegistry[url].callback.push(callback);\n\t\t}\n\t\turlRegistry[url] = code || {\n\t\t\tcallback: [callback]\n\t\t};\n\t\tif (code) return;\n\t\tlet req = new XMLHttpRequest();\n\t\treq.open('GET', url, true);\n\t\treq.onreadystatechange = () => {\n\t\t\tif (req.readyState === 4) {\n\t\t\t\tlet callbacks = urlRegistry[url].callback;\n\t\t\t\tif (req.status === 200) {\n\t\t\t\t\turlRegistry[url] = req.responseText;\n\t\t\t\t}\n\t\t\t\tif (!cache) delete urlRegistry[url];\n\t\t\t\tcallbacks.forEach(cb => cb(req.responseText, req.status));\n\t\t\t}\n\t\t};\n\t\treq.send();\n\t},\n\n\timport: function(path, callback = emptyFunc) {\n\t\tconst register = (code) => {\n\t\t\tcode && registerTag(code, document.body, Zino);\n\t\t\tcallback();\n\t\t};\n\n\t\tlet url = (this.path || '') + path;\n\t\tif (typeof path !== 'string') return register(path); \n\t\tZino.fetch(url, (data, status) => {\n\t\t\tlet path = url.replace(/[^\\/]+$/g, '');\n\t\t\tif (status === 200) {\n\t\t\t\tlet code;\n\t\t\t\ttry {\n\t\t\t\t\t// if we have HTML input\n\t\t\t\t\tif (data.trim().indexOf('<') === 0) {\n\t\t\t\t\t\t// convert it to JS\n\t\t\t\t\t\tdata = parse(data);\n\t\t\t\t\t}\n\t\t\t\t\tcode = new Function('return ' + data.replace(/url\\((\\\\*['\"])?(.*?)\\1\\)/g, function(g, quote, url) {\n\t\t\t\t\t\t\tif (url.indexOf('data:') === 0 || url.indexOf('http') === 0 || url.indexOf('//') === 0 || url.indexOf('/') === 0) return g;\n\t\t\t\t\t\t\treturn 'url(' + path + url + ')';\n\t\t\t\t\t\t}).replace(/\\bZino.import\\s*\\(/g, 'Zino.import.call({path: ' + JSON.stringify(path) + '}, ').trim().replace(/;$/, ''))();\n\t\t\t\t} catch(e) {\n\t\t\t\t\te.message = 'Unable to import tag ' + url.replace(/.*\\//g, '') + ': ' + e.message;\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t\tregister(code);\n\t\t\t}\n\t\t}, true);\n\t}\n};\nwindow.Zino = Zino;\non('publish-style', data => {\n\tif (typeof data.tagName === 'string' && data.styles.length > 0) {\n\t\tif (document.getElementById('style:' + data.tagName)) return;\n\t\tlet style = document.createElement('style');\n\t\tstyle.innerHTML = data.styles;\n\t\tstyle.id = 'style:' + data.tagName;\n\t\tdocument.head.appendChild(style);\n\t}\n});\non('--zino-rerender-tag', tag => dirtyTags.indexOf(tag) < 0 && dirtyTags.push(tag));\ntrigger('publish-style', '[__ready] { contain: content; }');\n$('[rel=\"zino-tag\"]', document).forEach(tag => Zino.import(tag.href));\ntagObserver.observe(document.body, {\n\tsubtree: true,\n\tchildList: true\n});\n\nrequestAnimationFrame(function reRender() {\n\twhile (dirtyTags.length > 0) {\n\t\trender(dirtyTags.shift());\n\t}\n\trequestAnimationFrame(reRender);\n});\n"],"names":["merge","target","args","forEach","all","arg","HTMLElement","propDetails","value","writable","obj","attribute","isObj","Object","getOwnPropertyDescriptor","uuid","replace","r","Math","random","c","toString","isFn","fn","emptyFunc","eventQueue","publishEvent","type","data","name","indexOf","trigger","index","result","on","push","off","one","self","apply","arguments","attachEvent","el","events","host","addEventListener","findEl","selector","node","slice","call","querySelectorAll","length","parentNode","keys","eventObj","handlers","event","e","getHost","tagFilter","tagsCreated","dataResolver","attr","isArray","prototype","setDataResolver","resolver","Tag","tagName","attributes","children","toLowerCase","tag","reduce","a","b","__complexity","getElementsByTagName","dom","concat","filter","child","setFilter","clearTagsCreated","getTagsCreated","created","getInnerHTML","map","babelHelpers.typeof","join","createElement","document","createTextNode","setAttribute","__vdom","functions","innerHTML","applyText","domChild","match","childNodes","html","replaceChild","applyDOM","vdom","getAttribute","id","removeAttribute","appendChild","nodeType","nodeValue","removeChild","renderOptions","key","oldID","dataRegistry","tagRegistry","defaultFunctions","props","attrName","g","resolveData","mounting","registerTag","Zino","firstElement","initializeTag","mount","ignoreRender","entry","render","noEvents","subEvents","renderTag","registryEntry","sibling","className","__i","isRendered","ownerDocument","hostEvents","childEvents","isNotSelf","__ready","defineAttribute","__s","initializeNode","bind","desc","get","defineProperty","val","getAttributes","attrs","Error","message","renderCallbacks","renderedSubElements","renderedDOM","__subs","unmountTag","idx","len","subEl","subElEvents","splice","subElements","abs","noRenderCallback","callback","attachSubEvents","count","__eventsAttached","actual","onready","unmount","propsOnly","element","styles","body","isComplex","substr","m1","m2","toUpperCase","setElementAttr","source","baseAttrs","handleStyles","code","style","global","trim","selectors","split","RegExp","tagRegExp","attrRegExp","commentRegExp","syntax","safeAccess","toArray","spread","renderStyle","baseCode","parse","resultObject","usesMerge","usesRenderStyle","usesSpread","lastIndex","level","tagStack","getData","handleText","text","isAttr","cat","exec","frag","substring","makeAttributes","content","m","x","$1","$2","expected","pop","helperFunctions","JSON","stringify","urlRegistry","window","zinoTagRegistry","dirtyTags","tagObserver","MutationObserver","added","record","addedNodes","removed","removedNodes","$","subTag","context","url","cache","req","XMLHttpRequest","open","onreadystatechange","readyState","callbacks","status","responseText","cb","send","path","register","fetch","Function","quote","getElementById","head","import","href","observe","requestAnimationFrame","reRender","shift"],"mappings":"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"}